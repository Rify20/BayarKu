<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="utf-8"/>
  <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
  <title>Login - BayarKu</title>

  <script src="https://cdn.tailwindcss.com?plugins=forms"></script>
  <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@200;300;400;500;600;700;800&display=swap" rel="stylesheet"/>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: { primary: "#137fec" },
          fontFamily: { display: ["Manrope","sans-serif"] }
        }
      }
    }
  </script>
</head>
<body class="bg-[#f6f7f8] font-display min-h-screen flex items-center justify-center px-4">
  <div class="w-full max-w-md rounded-2xl bg-white shadow-xl p-6">
    <h1 class="text-2xl font-extrabold text-[#111418]">Login BayarKu</h1>
    <p class="text-sm text-[#617589] mt-1">Masuk pakai email & password (Supabase).</p>

    <div class="mt-5 space-y-3">
      <div>
        <label class="text-sm font-bold text-[#111418]">Email</label>
        <input id="email" class="mt-1 w-full rounded-xl border px-3 py-2" type="email" placeholder="email@domain.com"/>
      </div>

      <div>
        <label class="text-sm font-bold text-[#111418]">Password</label>
        <input id="password" class="mt-1 w-full rounded-xl border px-3 py-2" type="password" placeholder="••••••••"/>
      </div>

      <div id="msg" class="hidden text-sm rounded-xl p-3"></div>

      <button id="btnLogin" class="w-full rounded-xl bg-primary text-white font-extrabold py-2.5">
        Login
      </button>

      <button id="btnRegister" class="w-full rounded-xl border border-primary/30 text-primary font-extrabold py-2.5">
        Register
      </button>

      <button id="btnBack" class="w-full rounded-xl border font-bold py-2.5">
        Kembali ke Splash
      </button>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <script>
    const SUPABASE_URL = "PASTE_SUPABASE_URL_DI_SINI";
    const SUPABASE_ANON_KEY = "PASTE_ANON_PUBLIC_KEY_DI_SINI";

    const supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

    const email = document.getElementById("email");
    const password = document.getElementById("password");
    const msg = document.getElementById("msg");

    function showMsg(text, ok=true){
      msg.classList.remove("hidden");
      msg.textContent = text;
      msg.className = ok
        ? "text-sm rounded-xl p-3 bg-green-500/10 text-green-700 border border-green-500/20"
        : "text-sm rounded-xl p-3 bg-red-500/10 text-red-700 border border-red-500/20";
    }

    document.getElementById("btnBack").onclick = () => location.href = "index.html";

    document.getElementById("btnLogin").onclick = async () => {
      try{
        const { error } = await supabase.auth.signInWithPassword({
          email: email.value.trim(),
          password: password.value
        });
        if (error) throw error;
        showMsg("Login sukses. Pindah ke dashboard...", true);
        setTimeout(()=> location.href="dashboard.html", 600);
      }catch(e){
        console.error(e);
        showMsg(e.message || "Login gagal", false);
      }
    };

    document.getElementById("btnRegister").onclick = async () => {
      try{
        const { error } = await supabase.auth.signUp({
          email: email.value.trim(),
          password: password.value
        });
        if (error) throw error;
        showMsg("Register sukses. Kalau Supabase kamu pakai email confirmation, cek inbox dulu.", true);
      }catch(e){
        console.error(e);
        showMsg(e.message || "Register gagal", false);
      }
    };
  </script>
</body>
</html>
